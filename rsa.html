<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>RSA-шифрование на пальцах</title>
<meta name="title" content="RSA-шифрование на пальцах" />
<meta itemprop="name" content="RSA-шифрование на пальцах" />
<meta property="og:title" content="RSA-шифрование на пальцах" />

<meta name="description" content="Иллюстрация работы асимметричного RSA-шифрования на простых примерах" />
<meta itemprop="description" content="Иллюстрация работы асимметричного RSA-шифрования на простых примерах" />
<meta property="og:description" content="Иллюстрация работы асимметричного RSA-шифрования на простых примерах" />

<meta http-equiv="X-UA-Compatible" content="chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" />
<link rel="canonical" href="http://www.michurin.net/computer-science/rsa.html" />
<link rel="author" href="https://plus.google.com/102469310318512061897/posts" />
<script src="/js/onerror.min.js" integrity="fOtGG4+MbwbAS9bJR+x2QO/yxizt3rE9Uaj8aYYx5fAUCpFwvRhZ2V5vzlKbCXFx"></script>
<script
  src="https://code.jquery.com/jquery-1.12.4.min.js"
  integrity="sha256-ZosEbRLbNQzLpnKIkEdrPv7lOy9C27hHQ+Xp8a4MxAQ="
  crossorigin="anonymous"></script>
<script src="/js/main.min.js" integrity="l5dsg+lg+v3knV3JHTCNNZsrU6E2HqMb3vt+v2yD4Q+5n7+G0sc3WleVQ9cvphOv"></script>


<link rel="stylesheet" type="text/css" href="/lib/main.css">


<link rel="stylesheet" type="text/css" href="para.css">



</head>
<body>

 <div class="toc">
  <div class="toc_ctl">☰ Оглавление</div>
  <div class="toc_body">
    <ul>
<li><a href="/">Первая страница</a></li>
<li>Онлайн инструменты ▽<ul>
<li><a href="/online-tools/favicon-editor.html">Редактор иконок favicon.ico онлайн</a></li>
<li><a href="/online-tools/life-game.html">Игра «Жизнь» онлайн</a></li>
<li><a href="/online-tools/mandelbrot.html">Онлайн навигатор по множеству (фракталу) Мандельброта</a></li>
<li><a href="/online-tools/favicon-converter.html">Онлайн конвертер PNG в favicon.ico</a></li>
<li><a href="/online-tools/solar-system.html">Интерактивная схема солнечной системы</a></li>
<li><a href="/online-tools/julian-day.html">Пересчёт дат в Юлианские дни</a></li>
<li><a href="/online-tools/canvas-tranform-demo.html">Объяснение и онлайн-демо, как работает HTML5 canvas transform</a></li>
<li><a href="/online-tools/perlin-noise-tileable.html">Онлайн генератор периодических фонов</a></li>
<li><a href="/online-tools/hsv2rgb.html">Онлайн конвертер цветов из HSV в RGB</a></li>
<li><a href="/online-tools/url-escape-online.html">Онлайн URL-перекодировщик</a></li>
<li><a href="/online-tools/qr-code.html">Онлайн генератор QR-кодов</a></li>
<li><a href="/online-tools/hypercube.html">Покрутить 4D-гиперкуб</a></li>
<li><a href="/online-tools/map.html">Получение географических координат точки на карте</a></li>
<li><a href="/online-tools/minesweeper.html">«Сапёр» на бесконечном поле онлайн</a></li>
<li><a href="/online-tools/tgarden.html">Черепаший язык онлайн</a></li>
<li><a href="/online-tools/weight-bmi.html">Калькулятор индекса массы тела</a></li>
<li>Для самых маленьких ▽<ul>
<li><a href="/online-tools/toys/">Рисовалка для детей до трёх лет</a></li>
<li><a href="/online-tools/toys/robot/">«Робот» для детей с трёх-четырёх лет</a></li>
<li><a href="/online-tools/toys/piglet/intro.html">«Морской бой» для самых маленьких</a></li>
</ul>
</li>
<li><a href="/chat/">Простой чат</a></li>
</ul>
</li>
<li><a href="/tools/">Инструменты ▽</a><ul>
<li>Docker ▽<ul>
<li><a href="/tools/docker.html">Docker устанавливаем и разбираемся</a></li>
<li><a href="/tools/docker-ror.html">Пример использования Docker для изучения Ruby on Rails</a></li>
<li><a href="/tools/docker-mysql.html">Пример использования Docker для запуска MySQL</a></li>
<li><a href="/tools/docker-root.html">Почему docker требует root-прав</a></li>
</ul>
</li>
<li>JavaScript ▽<ul>
<li><a href="/tools/bookmarklet.html">Букмарклеты для JavaSctipt/HTML-разработчика</a></li>
<li><a href="/tools/javascript-use-strict.html">Использование "use strict" в JavaScript</a></li>
<li><a href="/tools/javascript-tips.html">Небольшая памятка по JavaScript</a></li>
<li><a href="/tools/javascript-minify.html">Простой минификатор/оптимизатор JavaScript</a></li>
<li><a href="/tools/chrome-extansions.html">Мои плагины для хрома</a></li>
</ul>
</li>
<li>Python ▽<ul>
<li><a href="/tools/python-methods.html">Сводная таблица методов основных типов данных Python 2 и 3</a></li>
<li><a href="/tools/python-tools.html">Инструменты для Python-разработчика</a></li>
<li><a href="/tools/python-cli.html">Удобная командная строка Python</a></li>
<li><a href="/tools/python-leaks.html">Утечки памяти в Python: метод <code>__del__</code> и сборка мусора</a></li>
<li><a href="/tools/python-threads.html">Работа с нитями в Python</a></li>
</ul>
</li>
<li>Файловая система ▽<ul>
<li><a href="/tools/files.html">FS: перемещение, переименование, архивирование</a></li>
<li><a href="/tools/systemd-sshfs.html">Монтирование sshfs с помощью systemd</a></li>
</ul>
</li>
<li>Shell ▽<ul>
<li><a href="/tools/bash-history.html">Работа с историей команд bash</a></li>
<li><a href="/tools/bash.html">Консоль/bash. настройка</a></li>
<li><a href="/tools/email-send-by-unix-shell-script.html">Отправка e-mail с картинками чистым shell скриптом</a></li>
<li><a href="/tools/audio.html">Конвертирование аудио</a></li>
<li><a href="/tools/video.html">Конвертирование видео</a></li>
</ul>
</li>
<li><a href="/tools/cpu-frequency.html">Управляем тактовой частотой процессора</a></li>
<li><a href="/tools/shared-ssh-mercurial.html">Совместный доступ к mercurial по SSH</a></li>
<li><a href="/tools/net-access.html">Передача файлов по сети</a></li>
<li><a href="/tools/security.html">Безопасное хранение и передача данных</a></li>
<li><a href="/tools/notifier.html">Нотификатор</a></li>
<li><a href="/tools/setup-xorg.html">Xorg. Настройка</a></li>
<li><a href="/tools/xorg-keyboard.html">Xorg. Настройка нестандартной клавиатуры</a></li>
<li><a href="/tools/synergy.html">Synergy: Много мониторов с одной клавиатурой и мышкой</a></li>
<li><a href="/tools/ssh.html">Ssh. Настройка</a></li>
<li><a href="/tools/ssh-tunnel.html">Ssh. Настройка туннелирования через NAT и firewall</a></li>
<li><a href="/tools/pidgin.html">Pidgin для хакеров</a></li>
<li><a href="/tools/printing.html">Печать</a></li>
<li><a href="/tools/usb-mount-umount.html">USB-Flash. монтирование</a></li>
<li><a href="/tools/udev-mtp.html">Доступ к данным по MTP</a></li>
<li><a href="/tools/aspell.html">Настройка aspell</a></li>
<li><a href="/tools/iptables.html">Iptables. Port knocking</a></li>
<li><a href="/tools/sudo.html">Sudo, sudoers, visudo</a></li>
<li><a href="/tools/swap-file.html">Swap в файле в Linux</a></li>
<li><a href="/tools/kind-kill.html">Добрый kill (gdb)</a></li>
<li><a href="/tools/remount-resize-tmpfs.html">Изменить размер tmp (tmpfs)</a></li>
<li><a href="/tools/usb-archlinux.html">Установка Arch Linux на USB-Flash</a></li>
<li><a href="/tools/qemu.html">Эмуляция в QEMU</a></li>
<li><a href="/tools/grub2.html">GRUB2 вручную</a></li>
<li><a href="/tools/system.html">Системные утилиты</a></li>
<li><a href="/tools/vi-exrc.html">Настройка редактора vi</a></li>
<li><a href="/tools/vi-guide.html">Краткое руководство по vi</a></li>
<li><a href="/tools/html.html">HTML-валидатор</a></li>
<li><a href="/tools/vds-intro.html">VDS/VPS</a><ul>
<li><a href="/tools/vds-setup.html">Начальная настройка</a></li>
<li><a href="/tools/vds-nginx-build.html">Сборка nginx</a></li>
<li><a href="/tools/vds-nginx.html">Настройка nginx</a></li>
<li><a href="/tools/vds-uwsgi-build.html">Сборка uWSGI (Django+CGI)</a></li>
<li><a href="/tools/vds-uwsgi-config.html">Настройка uWSGI</a></li>
</ul>
</li>
<li><a href="/tools/netctl-on-ubuntu.html">Управление сетью в Ubuntu с помощью netctl (Arch Linux)</a></li>
<li><a href="/tools/wifi-linux.html">Настройка WiFi точки доступа под Linux</a></li>
</ul>
</li>
<li>CS: Искусственный интеллект ▽<ul>
<li><a href="/computer-science/ml-precision-recall.html">Метрики в машинном обучении: precision, recall и не только</a></li>
<li><a href="/computer-science/precision-and-recall.html">Оценка точности классификатора</a></li>
<li><a href="/computer-science/artificial-intelligence/">Нейронные сети на простейших примерах</a><ul>
<li><a href="/computer-science/artificial-intelligence/what-is-neuron.html">Что такое нейрон (очень коротко)</a></li>
<li><a href="/computer-science/artificial-intelligence/task-for-one-neuron.html">Пример задачи и демонстрация, как нейрон её решает</a></li>
<li><a href="/computer-science/artificial-intelligence/learning-one-neuron.html">Пример обучения нейрона</a></li>
<li><a href="/computer-science/artificial-intelligence/behind-the-scenes.html">Что осталось за сценой в задаче для одного нейрона</a></li>
</ul>
</li>
<li><a href="/computer-science/ml-decision-tree/intro.html">Деревья принятия решений</a></li>
<li><a href="/computer-science/bayes/bayes.html">Байесовское машинное обучение</a></li>
<li>Примеры кода numpy, scipy, matplotlib<ul>
<li><a href="/computer-science/scipy/scipy_least_squares.html">Метод наименьших квадратов</a></li>
<li><a href="/computer-science/scipy/document_distance.html">Построение системы рекомендаций, на основе текстов</a></li>
<li><a href="/computer-science/scipy/reaction_diffusion.html">Диффузионные реакции (реакции с диффузией)</a></li>
</ul>
</li>
</ul>
</li>
<li>CS: Разное ▽<ul>
<li><a href="/computer-science/rsa.html">RSA-шифрование на пальцах</a></li>
<li><a href="/computer-science/sqrt-decomposition.html">SQRT-декомпозиция</a></li>
<li><a href="/computer-science/recursion.html">О пользе рекурсии</a></li>
<li><a href="/computer-science/bisect.html">Дискретная бисекция</a></li>
<li><a href="/computer-science/top-k.html">Top-K из N (куча)</a></li>
<li><a href="/computer-science/fast-power-fibonacci-numbers.html">Быстрое возведение в степень и подсчёт чисел Фибоначчи</a></li>
<li><a href="/computer-science/boolean-logic.html">Алгебра логики</a></li>
<li><a href="/computer-science/cpp-misc.html">Небольшая памятка по C++</a></li>
<li><a href="/computer-science/halting-problem.html">Проблема останова</a></li>
<li><a href="/servers/">Примеры простейших серверов на Python</a><ul>
<li><a href="/servers/one-child-per-client.html">Простейший форкающийся сервер</a></li>
<li><a href="/servers/prefork-server.html">Простейший prefork-сервер</a></li>
<li><a href="/servers/one-thread-per-client.html">Простейший многонитевой сервер</a></li>
<li><a href="/servers/thread-with-sharing.html">Многонитевой сервер с простым взаимодействием между нитями</a></li>
<li><a href="/servers/asynchronous.html">Асинхронный сервер</a></li>
</ul>
</li>
<li><a href="/computer-science/cumulative_moving_standard_deviation.html">Кумулятивное вычисление статистических характеристик</a></li>
<li><a href="/computer-science/five-problems.html">Пять задач, которые хорошо бы уметь решать за час</a></li>
</ul>
</li>
<li>Теория относительности ▽<ul>
<li><a href="/special-relativity/about.html">Об этих заметках</a></li>
<li><a href="/special-relativity/frame.html">Пространство-время как геометрия</a></li>
<li><a href="/special-relativity/phys.html">Физическая интерпретация</a></li>
<li><a href="/special-relativity/c-vel.html">Универсальность скорости света</a></li>
<li><a href="/special-relativity/sys-eq.html">Эквивалентность инерциальных систем отсчёта</a></li>
<li><a href="/special-relativity/rel.html">Относительность пространственных и временных интервалов</a></li>
<li><a href="/special-relativity/c.html">Движение быстрее света</a></li>
<li><a href="/special-relativity/twix.html">Парадокс близнецов</a></li>
<li><a href="/special-relativity/concl.html">Заключение</a></li>
</ul>
</li>
<li>Теория вероятностей ▽<ul>
<li><a href="/probability-theory/illusions.html">Как нас обманывает интуиция</a></li>
<li><a href="/probability-theory/Monty-Hall-problem.html">Парадокс Монти Холла</a></li>
<li><a href="/probability-theory/two-envelopes-problem.html">Парадокс двух конвертов</a></li>
</ul>
</li>
<li>Квантовая механика ▽<ul>
<li><a href="/quantum-mech/uncertainty-principle.html">Принцип неопределённости на классических примерах</a></li>
</ul>
</li>
<li>Фракталы ▽<ul>
<li><a href="/fractals/dim.html">Фрактальная размерность</a></li>
<li><a href="/fractals/trees.html">Фрактальные деревья</a></li>
<li><a href="/fractals/app.html">Применение фракталов</a></li>
<li><a href="/fractals/complex-dim.html">Комплексная размерность</a></li>
</ul>
</li>
<li><a href="/tetracub/">Гиперкуб</a></li>
<li><a href="/education/">Обучение и преподавание ▽</a><ul>
<li><a href="/education/school-help.html">О репетиторстве</a></li>
<li><a href="/education/test-errors.html">Типичные ошибки на экзаменах</a></li>
<li><a href="/education/test-prepare.html">Лёгкая подготовка к экзаменам</a></li>
<li><a href="/education/test-win.html">Как отвечать на экзамене</a></li>
</ul>
</li>
<li><a href="/health/howto-lose-fat.html">Как я худел</a></li>
<li>Личное ▽<ul>
<li><a href="/private/about.html">Обо мне (как бы резюме)</a></li>
<li><a href="/private/acknowledge.html">Благодарности</a></li>
<li><a href="/private/my-errors.html">Мои ошибки</a></li>
<li><a href="/we/">Немного фотографий</a></li>
<li><a href="/private/nonsense.html">Копирование этих материалов</a></li>
</ul>
</li>
</ul>
  </div>
 </div>

 <h1>Иллюстрация работы RSA на примере</h1>
<p>Вокруг алгоритмов шифрования с отрытым и закрытым ключом
существует множество недопониманий и мистификаций.
Здесь я хотел бы предельно коротко и наглядно, с конкретными
числами и минимумом формул, показать, как это работает.</p>
<p>Я не вдаюсь в теорию (не очень понятно, на какой уровень
подготовки читателя следует рассчитывать), но я уверен,
что прочитав эту короткую иллюстрацию, любому человеку будет проще
разобраться в формулах и строгих доказательствах.</p>
<p>Итак. Допустим, я хочу получить от вас некие данные.
Мы с вам не хотим, чтобы эти данные узнал кто-то,
кроме нас. И у нас нет никакой уверенности в надёжности
канала передачи данных. Приступим.</p>
<h2>Шаг первый. Подготовка ключей</h2>
<p>Я должен
проделать предварительные действия: сгенерировать
публичный и приватный ключ.</p>
<ul>
<li>Выбираю два простых числа. Пусть это будет
<code>p=3</code> и <code>q=7</code>.</li>
<li>Вычисляем <em>модуль</em> — произведение наших <code>p</code> и <code>q</code>: <code>n=p×q=3×7=21</code>.</li>
<li>Вычисляем <em>функцию Эйлера</em>: <code>φ=(p-1)×(q-1)=2×6=12</code>.</li>
<li>Выбираем число <code>e</code>, отвечающее следующим критериям:
(i) оно должно быть простое,
(ii) оно должно быть меньше <code>φ</code> — остаются варианты: 3, 5, 7, 11,
(iii) оно должно быть взаимно простое с <code>φ</code>; остаются варианты 5, 7, 11.
Выберем <code>e=5</code>. Это, так называемая, <em>открытая экспонента</em>.</li>
</ul>
<p>Теперь пара чисел <code>{e, n}</code> — это мой открытый ключ. Я отправляю его
вам, чтобы вы зашифровали своё сообщение. Но для меня это ещё не всё.
Я должен получить закрытый ключ.</p>
<p>Мне нужно вычислить число <code>d</code>, обратное <code>е</code> по модулю <code>φ</code>. То есть
остаток от деления по модулю <code>φ</code> произведения <code>d×e</code> должен быть
равен 1. Запишем это в обозначениях, принятых во многих языках
программирования: <code>(d×е)%φ=1</code>. Или <code>(d×5)%12=1</code>. <code>d</code> может быть
равно 5 (<code>(5×5)%12=25%12=1</code>), но чтобы оно не путалось с <code>e</code>
в дальнейшем повествовании,
давайте возьмём его равным 17. Можете проверить сами, что
<code>(17×5)%12</code> действительно равно 1 (<code>17×5-12×7=1</code>). Итак <code>d=17</code>.
Пара <code>{d, n}</code> — это секретный ключ, его я оставляю у себя. Его
нельзя сообщать никому. Только обладатель секретного
ключа может расшифровать то, что было зашифровано открытым ключом.</p>
<h2>Шаг второй. Шифрование</h2>
<p>Теперь пришла ваша очередь шифровать ваше сообщение.
Допустим, ваше сообщение это число 19. Обозначим его
<code>P=19</code>. Кроме него у вас уже есть мой открытый ключ:
<code>{e, n} = {5, 21}</code>. Шифрование выполняется по следующему
алгоритму:</p>
<ul>
<li>Возводите ваше сообщение в степень <code>e</code> по модулю <code>n</code>.
  То есть, вычисляете 19 в степени 5 (2476099) и берёте
  остаток от деления на 21. Получается 10 — это ваши закодированные данные.</li>
</ul>
<p class="small">Строго говоря, вам вовсе незачем вычислять огромное число
«19 в степени 5». При каждом умножении достаточно вычислять
не полное произведение, а только остаток от деления на 21.
Но это уже детали реализации вычислений, давайте не будем
в них углубляться.</p>
<p>Полученные данные <code>E=10</code>, вы отправляете мне.</p>
<p>Здесь надо заметить, что сообщение <code>P=19</code> не должно быть больше
<code>n=21</code>. иначе ничего не получится.</p>
<h2>Шаг третий. Расшифровка</h2>
<p>Я получил ваши данные (<code>E=10</code>), и у меня имеется закрытый ключ
<code>{d, n} = {17, 21}</code>.</p>
<p>Обратите внимание на то, что открытый ключ не может расшифровать
сообщение. А закрытый ключ я никому не говорил. В этом вся прелесть
асимметричного шифрования.</p>
<p>Начинаем раскодировать:</p>
<ul>
<li>Я делаю операцию, очень похожую на вашу, но вместо <code>e</code> использую <code>d</code>.
  Возвожу <code>E</code> в степень <code>d</code>: получаю 10 в степени 17 (позвольте, я не
  буду писать единичку с семнадцатью нулями). Вычисляю остаток от деления
  на 21 и получаю 19 — ваше сообщение.</li>
</ul>
<p>Заметьте, никто, кроме меня (даже вы!) не может расшифровать ваше сообщение
(<code>E=10</code>), так как ни у кого нет закрытого ключа.</p>
<h2>В чём гарантия надёжности шифрования</h2>
<p>Надёжность шифрования обеспечивается тем, что третьему лицу
(старающемуся взломать шифр) очень трудно вычислить закрытый ключ
по открытому. Оба ключа вычисляются из одной пары простых чисел
(<code>p</code> и <code>q</code>). То есть ключи связаны между собой. Но установить эту
связь очень сложно. Основной загвоздкой является декомпозиция
модуля <code>n</code> на простые сомножители <code>p</code> и <code>q</code>. Если число является
произведением двух очень больших простых чисел, то его очень трудно разложить
на множители.</p>
<p>Постараюсь это показать на примере. Давайте разложим на множители число 360:</p>
<ul>
<li>сразу ясно, что оно делится на два (получили 2)</li>
<li>оставшееся 180 тоже, очевидно чётное (ещё 2)</li>
<li>90 — тоже чётное (ещё двойка)</li>
<li>45 не делится на 2, но следующая же попытка оказывается успешной — оно делится на три (получили 3)</li>
<li>15 тоже делится на 3</li>
<li>5 — простое.</li>
</ul>
<p>Мы на каждом шагу, практически без перебора, получали всё новые и
новые множители, легко получив полное разложение 360=2×2×2×3×3×5</p>
<p>Давайте теперь возьмём число 361. Тут нам придётся помучиться.</p>
<ul>
<li>оно не чётное</li>
<li>три — нет, не делится</li>
<li>пять (допустим, мы поступаем умно и перебираем только простые числа, хотя, на практике, поиск больших простых чисел, сам по себе, является сложной задачей) — не подходит</li>
<li>семь? — нет.</li>
<li>…</li>
<li>и только 19 даст нам ответ: 361=19×19.</li>
</ul>
<p>При использовании больших чисел, задача становится очень сложной.
Это позволяет надеяться, что у взломщика просто не хватит вычислительных
ресурсов, чтобы сломать ваш шифр за обозримое время.</p>
<h2>А как это всё работает на практике?</h2>
<p>Многие читатели спрашивают, как всё это применяется на
практике. Давайте рассмотрим чуть более приближенный
к жизни пример. Зашифруем и расшифруем слово «КРОТ»,
предложенное одним из читателей. А заодно, бегло
рассмотрим, какие проблемы при этом встречаются и
как они решаются.</p>
<p>Сперва сгенерируем ключи с чуть бо&#769;льшими числами.
Они не так наглядны, но позволят нам шифровать не только
числа от нуля до 20.</p>
<p>Оттолкнёмся от пары простых чисел <code>{p, q} = {17, 19}</code>.
Пусть наш открытый ключ будет <code>{e, n} = {5, 323}</code>, а
закрытый <code>{d, n} = {173, 323}</code>.</p>
<p>Мы готовы к шифрованию. Переведём наше слово в цифровое
представление. Мы можем взять просто номера букв в алфавите.
У нас получится последовательность чисел: 11, 17, 15, 19.</p>
<p>Мы можем зашифровать каждое из этих чисел открытым
ключом <code>{e, n} = {5, 323}</code> и получить
шифровку 197, 272, 2, 304. Эти числа можно передать
получателю, обладающему закрытым ключом <code>{d, n} = {173, 323}</code>
и он всё расшифрует.</p>
<h3>Немного о сложностях</h3>
<p>На самом деле, изложенный способ шифрования очень слаб и никогда
не используется. Причина проста — шифрование по буквам.
Одна и та же буква будет шифроваться одним и тем же числом.
Если злоумышленник перехватит достаточно большое
сообщение, он сможет догадаться о его содержимом.
Сперва он обратит внимание на частые коды пробелов
и разделит шифровку на слова. Потом он заметит однобуквенные
слова и догадается, как кодируются буквы «a», «и», «o», «в», «к»…
Путём недолгого перебора, он вычислит дополнительные буквы
по коротким словам, типа «но», «не», «по». И по более длинным
словам без труда восстановит все оставшиеся буквы.</p>
<p>Таким образом, злоумышленнику не придётся отгадывать
ваши секретные ключи. Он взломает ваше сообщение,
не зная их.</p>
<p>Чтобы этого не происходило, используются специальные
дополнительные алгоритмы, суть которых в том, что каждая
предыдущая часть сообщения начинает влиять на следующую.</p>
<p>Упрощённо, это выглядит так. Перед шифрованием, мы применяем
к сообщению правило: <code>b := (b + a) % n</code>. Где <code>a</code> — предыдущая
часть сообщения, а <code>b</code> — следующая. То есть наше сообщение
(11, 17, 15, 19) изменяется. 11 остаётся без изменений.
17 превращается в <code>(11 + 17) % 323 = 28</code>. 15 становится
<code>(15 + 28) % 323 = 43</code>. A 19 превращается в 62.</p>
<p>Последовательность (11, 28, 43, 62) получается
«запутанной». Все буквы в ней как бы перемешаны, в том
смысле, что на каждый код влияет не одна буква, а все
предыдущие.</p>
<p>Тот, кто получит ваше сообщение, должен будет
проделать обратную операцию, со знаком «минус»:
<code>b := (b - a) % n</code>. И только тогда он получит коды
букв.</p>
<p class="small">На практике, в исходное сообщение специально
добавляются случайные и бессмысленные буквы в
начало. Чтобы даже по первому коду было невозможно
ничего понять. Получатель просто отбрасывает
начало сообщения.</p>
<p class="small">То есть мы можем добавить случайное число в начало
и получить (299, 11, 17, 15, 19). После перемешивания
получится: 299, 310, 4, 19, 38. После шифрования
уже невозможно будет догадаться где была какая буква.</p>
<p>В реальной жизни всё ещё немного сложнее. Блоки,
на которые бьётся сообщение длиннее одной буквы.
Поэтому, сперва применяются алгоритмы выравнивания,
потом алгоритмы разбиения на блоки с перепутыванием,
и только потом применяется само RSA-шифрование.</p>
<p>Получатель делает всё в обратном порядке: расшифровывает,
«распутывает» блоки и отбрасывает ненужную информацию,
добавленную просто для выравнивания (чтобы сообщение
можно было разбить на целое число блоков).</p>
<p>Детали и принципы формирования блоков можно почитать
<a href="https://en.wikipedia.org/wiki/Block_cipher_mode_of_operation#Electronic_codebook_.28ECB.29">тут</a>.
Я же в этой заметке хотел рассказать только про RSA.
Надесь, удалось.</p>

<hr><div class="ya-site-form ya-site-form_inited_no" onclick="return {'action':'http://www.michurin.net/yandex-serch-results.html','arrow':false,'bg':'transparent','fontsize':12,'fg':'#000000','language':'ru','logo':'rb','publicname':'Поиск по www.michurin.net','suggest':true,'target':'_self','tld':'ru','type':2,'searchid':2115238,'webopt':true,'websearch':false,'input_fg':'#000000','input_bg':'#ffffff','input_fontStyle':'normal','input_fontWeight':'normal','input_placeholder':'Поиск по сайту от Яндекса','input_placeholderColor':'#999999','input_borderColor':'#333333'}"><form action="http://yandex.ru/sitesearch" method="get" target="_self"><input type="hidden" name="searchid" value="2115238"/><input type="hidden" name="l10n" value="ru"/><input type="hidden" name="reqenc" value="utf-8"/><input type="text" name="text" value=""/><input type="submit" value="Найти"/></form></div><style type="text/css">.ya-page_js_yes .ya-site-form_inited_no { display: none; }</style><script type="text/javascript">(function(w,d,c){var s=d.createElement('script'),h=d.getElementsByTagName('script')[0],e=d.documentElement;if((' '+e.className+' ').indexOf(' ya-page_js_yes ')===-1){e.className+=' ya-page_js_yes';}s.type='text/javascript';s.async=true;s.charset='utf-8';s.src=(d.location.protocol==='https:'?'https:':'http:')+'//site.yandex.net/v2.0/js/all.js';h.parentNode.insertBefore(s,h);(w[c]||(w[c]=[])).push(function(){Ya.Site.Form.init()})})(window,document,'yandex_site_callbacks');</script>

 

 
 <hr>
 <div class="mail">
  <textarea rows="7" placeholder="Написать письмо автору"></textarea>
  <br>
  <button>Отправить</button>
 </div>
 

<!-- Yandex.Metrika counter -->
<script type="text/javascript">
(function (d, w, c) {
    (w[c] = w[c] || []).push(function() {
        try {
            w.yaCounter24820832 = new Ya.Metrika({id:24820832,
                    webvisor:true,
                    clickmap:true,
                    trackLinks:true,
                    accurateTrackBounce:true,
                    trackHash:true});
        } catch(e) { }
    });

    var n = d.getElementsByTagName("script")[0],
        s = d.createElement("script"),
        f = function () { n.parentNode.insertBefore(s, n); };
    s.type = "text/javascript";
    s.async = true;
    s.src = (d.location.protocol == "https:" ? "https:" : "http:") + "//mc.yandex.ru/metrika/watch.js";

    if (w.opera == "[object Opera]") {
        d.addEventListener("DOMContentLoaded", f, false);
    } else { f(); }
})(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="//mc.yandex.ru/watch/24820832" style="position:absolute; left:-9999px;" alt="" /></div></noscript>
<!-- /Yandex.Metrika counter -->

<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-39255637-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://' : 'http://') + 'stats.g.doubleclick.net/dc.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

</body>
</html>
